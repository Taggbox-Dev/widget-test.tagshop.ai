"use strict";(self.webpackChunkembed_widget=self.webpackChunkembed_widget||[]).push([[3013,7775],{44238:(e,t,i)=>{i.d(t,{bs:()=>r});var s=i(31530),l=i(7665),o=i(83884),a=i(10753),d=i(89620);let n=[];const r=e=>{e.persist();const t=e.target,{network:i,itemId:s,themeId:l}=t.dataset;if(1!=i||[3,4,16,47,50,55,60].includes(l))n.includes(e)||n.push(e);else{const e=document.querySelector(`.tb_media-${s}`);e&&(e.style.display="none")}1===n.length&&c()},c=async()=>{var e;const{postData:t,wall:i}=l.A.getState().appData;if(!i||!Object.keys(i).length||!n.length)return;const{User:r,Wall:h}=i,m=null===r||void 0===r?void 0:r.id,v=(o.HY,null===h||void 0===h?void 0:h.id),p=null===(e=n[0])||void 0===e?void 0:e.target,{filterId:g,network:b,itemId:_,load:f}=p.dataset,w=document.querySelector(`img[data-item-id="${_}"]`),x=null!==t&&void 0!==t&&t.completeDataObject?Object.values(t.completeDataObject).filter((e=>e.id===_)):[];if(null!==x&&void 0!==x&&x.length){var y;const e=await(async e=>["taggbox.com","tagbox.com","tagembed.com","socialwalls.com"].some((t=>e.includes(t)))||await fetch(e).then((e=>e.ok)).catch((()=>!1)))(null===(y=x[0])||void 0===y?void 0:y.postFileNew);if(!e&&w){if([2,18,3,28].includes(+b)&&"0"===f&&"34"!==g&&!p.src.includes("cloud.taggbox.com")){const e=((e,t,i)=>{var s,l,o,a,d;const{UserPlan:n,Wall:r}=t;return{table_name:null===n||void 0===n?void 0:n.db_table,...e,...null!==i&&void 0!==i&&i.length?{feedId:null===(s=i[0])||void 0===s?void 0:s.feedId,type:null===(l=i[0])||void 0===l?void 0:l.type,link:null===(o=i[0])||void 0===o?void 0:o.link,postFile:null===(a=i[0])||void 0===a?void 0:a.postFile,mediaFile:null===(d=i[0])||void 0===d?void 0:d.mediaFile}:{},url:null===r||void 0===r?void 0:r.url}})({wallId:v,postId:_,ownerId:m},i,x);try{const{data:t}=await(new d.A).post(o.t5,e,{headers:a.ML}),i=o.HY||o.MH?"":`https://images.${o.QR}/`;p.src="18"===b?`${i}${t.media}`:t.media}catch{p.src=s.gX}finally{u(p)}}else p.src=s.gX,u(p);n.shift(),c()}else{const e=`${s.th}/media/images/no-image.svg`;p.src=e,p.srcset=e,u(p),n.shift()}}},u=e=>e.setAttribute("data-load","1")},23013:(e,t,i)=>{i.r(t),i.d(t,{default:()=>c});var s=i(82483),l=i(88620),o=(i(46262),i(83884)),a=i(7775),d=i(56723);const n=s.lazy((()=>Promise.all([i.e(8819),i.e(8071)]).then(i.bind(i,34051)))),r=JSON.parse(window.localStorage.getItem("mediaDimension"));class c extends s.PureComponent{constructor(e){super(e),this.mediaSize=e=>this.props.mediaSizeCallback(e),this.state={mediaSize:{height:null!=r?r[0]:"85vh",width:null!=r?r[1]:"85vh"}}}render(){const{Post:e,wallID:t,size:i,onUpdateProdImgIdx:r}=this.props,c={clickable:!0,bulletClass:"tb_rp_bullet"};return(0,d.jsx)("div",{className:"tb_rp_media_holder",children:(0,d.jsx)(l.RC,{ref:this.splideRef,direction:"horizontal",passiveListeners:!0,pagination:c,onSlideChange:e=>r(e.activeIndex),children:e.mediaList.map(((r,c)=>(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(l.qr,{children:l=>{let{isActive:u}=l;return(0,d.jsx)(d.Fragment,{children:[2,4].includes(r.type)||!u?(0,d.jsx)(a.default,{ImageClass:"tb_rp_s_image",Post:e,mediaOnly:r,size:i,hotspot:!!r.product.length&&o.HY}):[3,5].includes(r.type)?(0,d.jsx)(s.Suspense,{fallback:(0,d.jsx)(d.Fragment,{}),children:(0,d.jsx)(n,{VideoClass:"tb_rp_video",media:r.video.full,mediaPoster:r.image.original,Post:{...e,media:{video:r.video,image:r.image}},wallID:t,size:i,isCover:!0,controls:!1,autoPlay:u,muted:false,index:c})}):null})}},c)})))})})}}},82803:(e,t,i)=>{i.d(t,{A:()=>m});var s=i(82483),l=i(12251),o=i(99998),a=i(76467),d=i(99009),n=i(29269),r=i(56723);const c=(0,s.memo)((e=>{let{item:t}=e;const i=t.discount>0&&t.discount!==t.price,s=t.discount>0?t.discount:t.price;return(0,r.jsxs)("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"tb_tooltip_wrap",children:[(0,r.jsx)("div",{className:"tb_p_tooltip_title",children:t.title}),i&&(0,r.jsxs)("div",{className:"tb_p_tooltip_price tb_price_disabled",children:[t.currency,t.price]}),(t.price>0||t.discount>0)&&(0,r.jsxs)("div",{className:"tb_p_tooltip_price",children:[t.currency,s]})]})})),u=e=>{let{products:t,appData:i,Post:l}=e;const[u,h]=(0,s.useState)(null),m=(0,s.useMemo)((()=>{var e,t;return(null===i||void 0===i||null===(e=i.wall)||void 0===e||null===(t=e.ProductSetting)||void 0===t?void 0:t.Hotspot)||{}}),[i]),v=(0,s.useCallback)((e=>{null!==i&&void 0!==i&&i.wall&&(0,n.hq)({})}),[i,l]),p=(0,s.useCallback)(((e,t)=>{e.stopPropagation(),v(t),window.open(t.url,"_blank")}),[v]);return null!==m&&void 0!==m&&m.status?t.map(((e,t)=>{const i=`hotspot-${e.id}-${(0,d.Ul)()}`,s=u===t;return(0,r.jsxs)("div",{id:i,className:"tb_hotspot_dot"+(s?" tb_hotspot_active_":""),role:"button",style:{top:e.hotspot.top,left:e.hotspot.left},onMouseEnter:()=>h(t),onMouseLeave:()=>h(null),onClick:t=>p(t,e),"data-tooltip-offset":7,children:[(0,r.jsx)("div",{className:"tb_hotspot__ "+(0===m.type?"tb_hotspot_ani__":""),children:t+1}),(0,o.createPortal)((0,r.jsx)(a.m_,{className:"tb_pro_tooltip",anchorSelect:`#${i}`,clickable:!0,children:(0,r.jsx)(c,{item:e})}),document.body)]},`${e.id}-${t}`)})):null},h=(0,s.memo)(u),m=(0,l.Ng)((e=>({appData:e.appData})))(h)},7775:(e,t,i)=>{i.r(t),i.d(t,{default:()=>c});var s=i(82483),l=i(99009),o=i(31530),a=i(21645),d=i(44238),n=i(82803),r=i(56723);class c extends s.PureComponent{constructor(e){var t,i;super(e),this.updateMediaDimensions=()=>{if(this.mediaRef.current){const{offsetHeight:e,offsetWidth:t}=this.mediaRef.current;this.setState({currentHeight:e,currentWidth:t})}},this.mediaSizeCalc=async()=>{const{Post:e,mediaOnly:t}=this.props,i=t||e.media;if((null===i||void 0===i||!i.height)&&(null===i||void 0===i||!i.width))try{var s;const{width:e,height:t}=await(0,l.TW)(null===i||void 0===i||null===(s=i.image)||void 0===s?void 0:s.small);this._isMounted&&this.setState({height:t,width:e})}catch(o){this._isMounted&&this.setState({height:300,width:300})}};const{mediaOnly:o,Post:a}=e;this.state={isVisible:!this.props.observer,height:(null===o||void 0===o?void 0:o.height)||(null===a||void 0===a||null===(t=a.media)||void 0===t?void 0:t.height)||0,width:(null===o||void 0===o?void 0:o.width)||(null===a||void 0===a||null===(i=a.media)||void 0===i?void 0:i.width)||0,currentHeight:0,currentWidth:0},this.mediaRef=s.createRef(),this.observer=null}componentDidMount(){this._isMounted=!0,requestAnimationFrame((()=>{this.updateMediaDimensions(),this.mediaSizeCalc()})),this.observer=new IntersectionObserver((e=>{let[t]=e;t.isIntersecting&&(this.setState({isVisible:!0}),this.observer.disconnect())}),{threshold:.01}),this.mediaRef.current&&this.observer.observe(this.mediaRef.current)}componentWillUnmount(){this._isMounted=!1,this.observer&&this.observer.disconnect()}render(){var e,t,i,s;const{ImageClass:l,Post:c,hotspot:u,size:h,blurBG:m,ProductSetting:v,mediaOnly:p}=this.props,{id:g,link:b,products:_}=c,f=p||(null===c||void 0===c?void 0:c.media),{isVisible:w,height:x,width:y,currentWidth:j,currentHeight:k}=this.state,P=h||100*x/y,S={paddingBottom:1===P?null:`${P}%`},$={backgroundImage:w?`url(${null===f||void 0===f||null===(e=f.image)||void 0===e?void 0:e.small})`:null},I=y>x?"100%":y/x*100+"%",C=y>x?x/y*100+"%":"100%",N=c.isProduct&&u,z={width:N&&h?I:null,height:N&&h?C:null};return(0,r.jsxs)("div",{className:`${l}_wrap_`,style:S,ref:this.mediaRef,children:[N&&m?(0,r.jsx)("div",{className:"tb_blur_bg_",style:$}):null,(0,r.jsxs)("div",{className:`${l}_wrap_in`,style:z,children:[N?(0,r.jsx)(n.A,{products:_,ProductSetting:v,hotspot:c.hotspot,dataPost:c}):null,w?(0,r.jsx)("img",{className:`${l} tb_media-${g}`,src:null===f||void 0===f||null===(t=f.image)||void 0===t?void 0:t.small,srcSet:`${null===f||void 0===f||null===(i=f.image)||void 0===i?void 0:i.small} 1x, ${null===f||void 0===f||null===(s=f.image)||void 0===s?void 0:s.large} 2x`,sizes:`${j}px`,loading:w?"eager":"lazy",decoding:"async",fetchPriority:w?"high":"low","data-id":g,height:k,width:j,"data-height":x,"data-width":y,"data-link":b,onLoad:this.onLoad,onError:e=>{e.target.src=`${o.th}/media/error/no-image.svg`,e.target.srcset=`${o.th}/media/error/no-image.svg`,(0,d.bs)(e)},alt:null===f||void 0===f?void 0:f.title,title:(0,a.Ay)(null===f||void 0===f?void 0:f.title)},g):null]})]})}}}}]);
//# sourceMappingURL=3013.810da2dd.chunk.js.map