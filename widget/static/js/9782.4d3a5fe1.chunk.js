"use strict";(self.webpackChunkembed_widget=self.webpackChunkembed_widget||[]).push([[9782],{70501:(e,t,i)=>{i.d(t,{bs:()=>r});var s=i(8159),l=i(56364),d=i(40329),o=i(32866),a=i(98409);let n=[];const r=e=>{e.persist();const t=e.target,{network:i,itemId:s,themeId:l}=t.dataset;if(1!=i||[3,4,16,47,50,55,60].includes(l))n.includes(e)||n.push(e);else{const e=document.querySelector(`.tb_media-${s}`);e&&(e.style.display="none")}1===n.length&&h()},h=async()=>{var e;const{postData:t,wall:i}=l.A.getState().appData;if(!i||!Object.keys(i).length||!n.length)return;const{User:r,Wall:u}=i,v=null===r||void 0===r?void 0:r.id,m=(d.HY,null===u||void 0===u?void 0:u.id),g=null===(e=n[0])||void 0===e?void 0:e.target,{filterId:p,network:b,itemId:f,load:w}=g.dataset,y=document.querySelector(`img[data-item-id="${f}"]`),$=null!==t&&void 0!==t&&t.completeDataObject?Object.values(t.completeDataObject).filter((e=>e.id===f)):[];if(null!==$&&void 0!==$&&$.length){var _;const e=await(async e=>["taggbox.com","tagbox.com","tagembed.com","socialwalls.com"].some((t=>e.includes(t)))||await fetch(e).then((e=>e.ok)).catch((()=>!1)))(null===(_=$[0])||void 0===_?void 0:_.postFileNew);if(!e&&y){if([2,18,3,28].includes(+b)&&"0"===w&&"34"!==p&&!g.src.includes("cloud.taggbox.com")){const e=((e,t,i)=>{var s,l,d,o,a;const{UserPlan:n,Wall:r}=t;return{table_name:null===n||void 0===n?void 0:n.db_table,...e,...null!==i&&void 0!==i&&i.length?{feedId:null===(s=i[0])||void 0===s?void 0:s.feedId,type:null===(l=i[0])||void 0===l?void 0:l.type,link:null===(d=i[0])||void 0===d?void 0:d.link,postFile:null===(o=i[0])||void 0===o?void 0:o.postFile,mediaFile:null===(a=i[0])||void 0===a?void 0:a.mediaFile}:{},url:null===r||void 0===r?void 0:r.url}})({wallId:m,postId:f,ownerId:v},i,$);try{const{data:t}=await(new a.A).post(d.t5,e,{headers:o.ML}),i=d.HY||d.MH?"":`https://images.${d.QR}/`;g.src="18"===b?`${i}${t.media}`:t.media}catch{g.src=s.gX}finally{c(g)}}else g.src=s.gX,c(g);n.shift(),h()}else{const e=`${s.th}/media/images/no-image.svg`;g.src=e,g.srcset=e,c(g),n.shift()}}},c=e=>e.setAttribute("data-load","1")},49782:(e,t,i)=>{i.r(t),i.d(t,{default:()=>h});var s=i(88094),l=i(19066),d=i(8159),o=i(17524),a=i(70501),n=i(15678);const r=s.lazy((()=>Promise.all([i.e(4076),i.e(1111)]).then(i.bind(i,1111))));class h extends s.PureComponent{constructor(e){var t,i;super(e),this.updateMediaDimensions=()=>{if(this.mediaRef.current){const{offsetHeight:e,offsetWidth:t}=this.mediaRef.current;this.setState({currentHeight:e,currentWidth:t})}},this.mediaSizeCalc=async()=>{const{Post:e,mediaOnly:t}=this.props,i=t||e.media;if((null===i||void 0===i||!i.height)&&(null===i||void 0===i||!i.width))try{var s;const{width:e,height:t}=await(0,l.TW)(null===i||void 0===i||null===(s=i.image)||void 0===s?void 0:s.small);this._isMounted&&this.setState({height:t,width:e})}catch(d){this._isMounted&&this.setState({height:300,width:300})}};const{mediaOnly:d,Post:o}=e;this.state={isVisible:!this.props.observer,height:(null===d||void 0===d?void 0:d.height)||(null===o||void 0===o||null===(t=o.media)||void 0===t?void 0:t.height)||0,width:(null===d||void 0===d?void 0:d.width)||(null===o||void 0===o||null===(i=o.media)||void 0===i?void 0:i.width)||0,currentHeight:0,currentWidth:0},this.mediaRef=s.createRef(),this.observer=null}componentDidMount(){this._isMounted=!0,requestAnimationFrame((()=>{this.updateMediaDimensions(),this.mediaSizeCalc()})),this.observer=new IntersectionObserver((e=>{let[t]=e;t.isIntersecting&&(this.setState({isVisible:!0}),this.observer.disconnect())}),{threshold:.01}),this.mediaRef.current&&this.observer.observe(this.mediaRef.current)}componentWillUnmount(){this._isMounted=!1,this.observer&&this.observer.disconnect()}render(){var e,t,i,l;const{ImageClass:h,Post:c,hotspot:u,size:v,blurBG:m,ProductSetting:g,mediaOnly:p}=this.props,{id:b,link:f,products:w}=c,y=p||(null===c||void 0===c?void 0:c.media),{isVisible:$,height:_,width:k,currentWidth:x,currentHeight:I}=this.state,S=v||100*_/k,j={paddingBottom:1===S?null:`${S}%`},P={backgroundImage:$?`url(${null===y||void 0===y||null===(e=y.image)||void 0===e?void 0:e.small})`:null},M=k>_?"100%":k/_*100+"%",O=k>_?_/k*100+"%":"100%",R=c.isProduct&&u,W={width:R&&v?M:null,height:R&&v?O:null};return(0,n.jsxs)("div",{className:`${h}_wrap_`,style:j,ref:this.mediaRef,children:[R&&m?(0,n.jsx)("div",{className:"tb_blur_bg_",style:P}):null,(0,n.jsxs)("div",{className:`${h}_wrap_in`,style:W,children:[R?(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)(n.Fragment,{}),children:(0,n.jsx)(r,{products:w,ProductSetting:g,hotspot:c.hotspot,dataPost:c})}):null,$?(0,n.jsx)("img",{className:`${h} tb_media-${b}`,src:null===y||void 0===y||null===(t=y.image)||void 0===t?void 0:t.small,srcSet:`${null===y||void 0===y||null===(i=y.image)||void 0===i?void 0:i.small} 1x, ${null===y||void 0===y||null===(l=y.image)||void 0===l?void 0:l.large} 2x`,sizes:`${x}px`,loading:$?"eager":"lazy",decoding:"async",fetchPriority:$?"high":"low","data-id":b,height:I,width:x,"data-height":_,"data-width":k,"data-link":f,onLoad:this.onLoad,onError:e=>{e.target.src=`${d.th}/media/error/no-image.svg`,e.target.srcset=`${d.th}/media/error/no-image.svg`,(0,a.bs)(e)},alt:null===y||void 0===y?void 0:y.title,title:(0,o.Ay)(null===y||void 0===y?void 0:y.title)},b):null]})]})}}}}]);