"use strict";(self.webpackChunkembed_widget=self.webpackChunkembed_widget||[]).push([[36,9782],{70501:(e,t,i)=>{i.d(t,{bs:()=>r});var s=i(8159),l=i(56364),d=i(40329),a=i(32866),o=i(98409);let n=[];const r=e=>{e.persist();const t=e.target,{network:i,itemId:s,themeId:l}=t.dataset;if(1!=i||[3,4,16,47,50,55,60].includes(l))n.includes(e)||n.push(e);else{const e=document.querySelector(`.tb_media-${s}`);e&&(e.style.display="none")}1===n.length&&h()},h=async()=>{var e;const{postData:t,wall:i}=l.A.getState().appData;if(!i||!Object.keys(i).length||!n.length)return;const{User:r,Wall:u}=i,m=null===r||void 0===r?void 0:r.id,v=(d.HY,null===u||void 0===u?void 0:u.id),g=null===(e=n[0])||void 0===e?void 0:e.target,{filterId:p,network:b,itemId:f,load:w}=g.dataset,y=document.querySelector(`img[data-item-id="${f}"]`),_=null!==t&&void 0!==t&&t.completeDataObject?Object.values(t.completeDataObject).filter((e=>e.id===f)):[];if(null!==_&&void 0!==_&&_.length){var x;const e=await(async e=>["taggbox.com","tagbox.com","tagembed.com","socialwalls.com"].some((t=>e.includes(t)))||await fetch(e).then((e=>e.ok)).catch((()=>!1)))(null===(x=_[0])||void 0===x?void 0:x.postFileNew);if(!e&&y){if([2,18,3,28].includes(+b)&&"0"===w&&"34"!==p&&!g.src.includes("cloud.taggbox.com")){const e=((e,t,i)=>{var s,l,d,a,o;const{UserPlan:n,Wall:r}=t;return{table_name:null===n||void 0===n?void 0:n.db_table,...e,...null!==i&&void 0!==i&&i.length?{feedId:null===(s=i[0])||void 0===s?void 0:s.feedId,type:null===(l=i[0])||void 0===l?void 0:l.type,link:null===(d=i[0])||void 0===d?void 0:d.link,postFile:null===(a=i[0])||void 0===a?void 0:a.postFile,mediaFile:null===(o=i[0])||void 0===o?void 0:o.mediaFile}:{},url:null===r||void 0===r?void 0:r.url}})({wallId:v,postId:f,ownerId:m},i,_);try{const{data:t}=await(new o.A).post(d.t5,e,{headers:a.ML}),i=d.HY||d.MH?"":`https://images.${d.QR}/`;g.src="18"===b?`${i}${t.media}`:t.media}catch{g.src=s.gX}finally{c(g)}}else g.src=s.gX,c(g);n.shift(),h()}else{const e=`${s.th}/media/images/no-image.svg`;g.src=e,g.srcset=e,c(g),n.shift()}}},c=e=>e.setAttribute("data-load","1")},60036:(e,t,i)=>{i.r(t),i.d(t,{default:()=>h});var s=i(88094),l=i(33578),d=(i(12755),i(40329)),a=i(49782),o=i(15678);const n=s.lazy((()=>Promise.all([i.e(5740),i.e(4027)]).then(i.bind(i,6570)))),r=JSON.parse(window.localStorage.getItem("mediaDimension"));class h extends s.PureComponent{constructor(e){super(e),this.mediaSize=e=>this.props.mediaSizeCallback(e),this.state={mediaSize:{height:null!=r?r[0]:"85vh",width:null!=r?r[1]:"85vh"}}}render(){const{Post:e,wallID:t,size:i,onUpdateProdImgIdx:r}=this.props,h={clickable:!0,bulletClass:"tb_rp_bullet"};return(0,o.jsx)("div",{className:"tb_rp_media_holder",children:(0,o.jsx)(l.RC,{ref:this.splideRef,direction:"horizontal",passiveListeners:!0,pagination:h,onSlideChange:e=>r(e.activeIndex),children:e.mediaList.map(((r,h)=>(0,o.jsx)(l.qr,{children:l=>{let{isActive:c}=l;return(0,o.jsx)(o.Fragment,{children:[2,4].includes(r.type)||!c?(0,o.jsx)(a.default,{ImageClass:"tb_rp_s_image",Post:e,mediaOnly:r,size:i,hotspot:d.HY}):[3,5].includes(r.type)?(0,o.jsx)(s.Suspense,{fallback:(0,o.jsx)(o.Fragment,{}),children:(0,o.jsx)(n,{VideoClass:"tb_rp_video",media:r.video.full,mediaPoster:r.image.original,Post:{...e,media:{video:r.video,image:r.image}},wallID:t,size:i,isCover:!0,controls:!1,autoPlay:c,muted:false,index:h})}):null})}},h)))})})}}},49782:(e,t,i)=>{i.r(t),i.d(t,{default:()=>h});var s=i(88094),l=i(19066),d=i(8159),a=i(17524),o=i(70501),n=i(15678);const r=s.lazy((()=>Promise.all([i.e(4076),i.e(1111)]).then(i.bind(i,1111))));class h extends s.PureComponent{constructor(e){var t,i;super(e),this.updateMediaDimensions=()=>{if(this.mediaRef.current){const{offsetHeight:e,offsetWidth:t}=this.mediaRef.current;this.setState({currentHeight:e,currentWidth:t})}},this.mediaSizeCalc=async()=>{const{Post:e,mediaOnly:t}=this.props,i=t||e.media;if((null===i||void 0===i||!i.height)&&(null===i||void 0===i||!i.width))try{var s;const{width:e,height:t}=await(0,l.TW)(null===i||void 0===i||null===(s=i.image)||void 0===s?void 0:s.small);this._isMounted&&this.setState({height:t,width:e})}catch(d){this._isMounted&&this.setState({height:300,width:300})}};const{mediaOnly:d,Post:a}=e;this.state={isVisible:!this.props.observer,height:(null===d||void 0===d?void 0:d.height)||(null===a||void 0===a||null===(t=a.media)||void 0===t?void 0:t.height)||0,width:(null===d||void 0===d?void 0:d.width)||(null===a||void 0===a||null===(i=a.media)||void 0===i?void 0:i.width)||0,currentHeight:0,currentWidth:0},this.mediaRef=s.createRef(),this.observer=null}componentDidMount(){this._isMounted=!0,requestAnimationFrame((()=>{this.updateMediaDimensions(),this.mediaSizeCalc()})),this.observer=new IntersectionObserver((e=>{let[t]=e;t.isIntersecting&&(this.setState({isVisible:!0}),this.observer.disconnect())}),{threshold:.01}),this.mediaRef.current&&this.observer.observe(this.mediaRef.current)}componentWillUnmount(){this._isMounted=!1,this.observer&&this.observer.disconnect()}render(){var e,t,i,l;const{ImageClass:h,Post:c,hotspot:u,size:m,blurBG:v,ProductSetting:g,mediaOnly:p}=this.props,{id:b,link:f,products:w}=c,y=p||(null===c||void 0===c?void 0:c.media),{isVisible:_,height:x,width:I,currentWidth:S,currentHeight:j}=this.state,P=m||100*x/I,k={paddingBottom:1===P?null:`${P}%`},$={backgroundImage:_?`url(${null===y||void 0===y||null===(e=y.image)||void 0===e?void 0:e.small})`:null},z=I>x?"100%":I/x*100+"%",C=I>x?x/I*100+"%":"100%",D=c.isProduct&&u,O={width:D&&m?z:null,height:D&&m?C:null};return(0,n.jsxs)("div",{className:`${h}_wrap_`,style:k,ref:this.mediaRef,children:[D&&v?(0,n.jsx)("div",{className:"tb_blur_bg_",style:$}):null,(0,n.jsxs)("div",{className:`${h}_wrap_in`,style:O,children:[D?(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)(n.Fragment,{}),children:(0,n.jsx)(r,{products:w,ProductSetting:g,hotspot:c.hotspot,dataPost:c})}):null,_?(0,n.jsx)("img",{className:`${h} tb_media-${b}`,src:null===y||void 0===y||null===(t=y.image)||void 0===t?void 0:t.small,srcSet:`${null===y||void 0===y||null===(i=y.image)||void 0===i?void 0:i.small} 1x, ${null===y||void 0===y||null===(l=y.image)||void 0===l?void 0:l.large} 2x`,sizes:`${S}px`,loading:_?"eager":"lazy",decoding:"async",fetchPriority:_?"high":"low","data-id":b,height:j,width:S,"data-height":x,"data-width":I,"data-link":f,onLoad:this.onLoad,onError:e=>{e.target.src=`${d.th}/media/error/no-image.svg`,e.target.srcset=`${d.th}/media/error/no-image.svg`,(0,o.bs)(e)},alt:null===y||void 0===y?void 0:y.title,title:(0,a.Ay)(null===y||void 0===y?void 0:y.title)},b):null]})]})}}}}]);